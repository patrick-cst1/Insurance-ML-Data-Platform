{
  "name": "master_batch_pipeline",
  "description": "Master orchestration for Bronze->Silver->Gold batch processing",
  "activities": [
    {
      "name": "Bronze_Ingestion",
      "type": "DatabricksNotebook",
      "dependsOn": [],
      "policy": {
        "timeout": "0.01:00:00",
        "retry": 2,
        "retryIntervalInSeconds": 30
      },
      "typeProperties": {
        "notebookPath": "/lakehouse/bronze/notebooks/ingest_policies",
        "baseParameters": {}
      }
    },
    {
      "name": "Bronze_Ingestion_Claims",
      "type": "DatabricksNotebook",
      "dependsOn": [],
      "typeProperties": {
        "notebookPath": "/lakehouse/bronze/notebooks/ingest_claims"
      }
    },
    {
      "name": "Bronze_Ingestion_Customers",
      "type": "DatabricksNotebook",
      "dependsOn": [],
      "typeProperties": {
        "notebookPath": "/lakehouse/bronze/notebooks/ingest_customers"
      }
    },
    {
      "name": "Silver_Clean_Policies",
      "type": "DatabricksNotebook",
      "dependsOn": [
        {
          "activity": "Bronze_Ingestion",
          "dependencyConditions": ["Succeeded"]
        }
      ],
      "typeProperties": {
        "notebookPath": "/lakehouse/silver/notebooks/clean_policies"
      }
    },
    {
      "name": "Silver_Enrich_Cosmos",
      "type": "DatabricksNotebook",
      "dependsOn": [
        {
          "activity": "Silver_Clean_Policies",
          "dependencyConditions": ["Succeeded"]
        }
      ],
      "typeProperties": {
        "notebookPath": "/lakehouse/silver/notebooks/enrich_from_cosmos"
      }
    },
    {
      "name": "Gold_Claims_Features",
      "type": "DatabricksNotebook",
      "dependsOn": [
        {
          "activity": "Silver_Enrich_Cosmos",
          "dependencyConditions": ["Succeeded"]
        }
      ],
      "typeProperties": {
        "notebookPath": "/lakehouse/gold/notebooks/create_claims_features"
      }
    },
    {
      "name": "Gold_Customer_Features",
      "type": "DatabricksNotebook",
      "dependsOn": [
        {
          "activity": "Silver_Enrich_Cosmos",
          "dependencyConditions": ["Succeeded"]
        }
      ],
      "typeProperties": {
        "notebookPath": "/lakehouse/gold/notebooks/create_customer_features"
      }
    },
    {
      "name": "Gold_Risk_Features",
      "type": "DatabricksNotebook",
      "dependsOn": [
        {
          "activity": "Gold_Claims_Features",
          "dependencyConditions": ["Succeeded"]
        },
        {
          "activity": "Gold_Customer_Features",
          "dependencyConditions": ["Succeeded"]
        }
      ],
      "typeProperties": {
        "notebookPath": "/lakehouse/gold/notebooks/create_risk_features"
      }
    }
  ],
  "triggers": [
    {
      "name": "DailySchedule",
      "type": "ScheduleTrigger",
      "recurrence": {
        "frequency": "Day",
        "interval": 1,
        "startTime": "2025-01-01T02:00:00Z",
        "timeZone": "UTC"
      }
    }
  ]
}
